<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Drawing on Canvas</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/roundSlider/1.3.2/roundslider.min.css" rel="stylesheet" />                                
<script src="https://cdnjs.cloudflare.com/ajax/libs/roundSlider/1.3.2/roundslider.min.js"></script>

<style>
#slider {
  position: absolute;
  top: 70px;
  left: 550px;
  z-index: -1
}

#myCanvas {
  position: absolute;
  top: -45px;
  left: 0px;
  z-index: 1;
  pointer-events: none;
}
</style>

</head>
<body>
    <div id="container">
      <canvas id="myCanvas" width="800" height="800"></canvas>
      <div id="slider"></div>
    </div>
<script>

var lines = [
    'Vicious Cyclist',
    '',
    'I chained you to a post,',
    'locked, left you like Lear to weather',
    'nights that turned your bones blue beneath',
    'peeling crimson skin. The sea-colored',
    '',
    'key on which hinged your security was lost,',
    'gobbled up by some hungry storm drain or',
    'perhaps threaded onto a length of thin wire worn',
    'about the grime-brindled neck of an itinerant shaman;',
    'I couldn\'t find a way to tell you this, friend.',
    '',
    'So I watched from a distance, peered',
    'around corners, deployed periscopes and angled mirrors:',
    '    a sparrow nested on your balding seat;',
    '    a spider spun webs amidst your spindly radii and ulnae;',
    '    a team of ants developed a trade route along your brittle chain,',
    '        clotted with black grease;',
    '    a dog found relief upon your verdigrised gears.',
    '',
    'I should have called someone, a serious,',
    'sturdy man with vice grips and bolt cutters',
    'with a name tag sewn into gore-tex coveralls',
    '',
    'He came for you regardless, bearded Bill or moustached Mike,',
    'some hirsute monosyllable,',
    'the situation forced to its crisis,',
    'else some slimy swamp mother birthed forth',
    'cyclopes and grendels to devour you like flesh from a rib',
    '',
    'It seems you will never again accompany me to that',
    'mist-shrouded spot where two rivers meet.']  

function draw(angle) {
    var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");
    context.clearRect(0, 0, canvas.width, canvas.height);

    var rotation = 9;
    var totalRotation = 0;

    context.save();
    context.font = "18px Serif";
    context.translate(-300, 400);
    context.rotate(-angle*Math.PI/180);

    lines.forEach(function(line, index, array) {
        var alpha = Math.cos(5*(totalRotation-angle) * Math.PI / 180).toFixed(1);
        context.fillStyle = "rgba(0, 0, 0," + alpha + ")";
        context.fillText(line, 400, 0);
        context.rotate(rotation * Math.PI / 180);
        totalRotation += rotation;
    })
    context.restore();
};

function redraw() {
    var value = $('#slider').roundSlider('getValue');
    var angle = 360 * (value/5000.0);
    draw(angle);
}

function onChange(e) {
    redraw()
}

$("#slider").roundSlider({
    radius: 250,
    width: 40,
    circleShape: "half-right",
    sliderType: "min-range",
    showTooltip: false,
    drag: "onChange",
    change: "onChange",
    value: 0,
    min: 0,
    max: 5000,
    step: 1
});

function down(amt) {
    var value = $('#slider').roundSlider('getValue');
    $('#slider').roundSlider('setValue', value + amt);
    redraw();
}

function up(amt) {
    var value = $('#slider').roundSlider('getValue');
    $('#slider').roundSlider('setValue', value - amt);
    redraw();
}

document.addEventListener('keydown', function(event) {
  switch (event.key) {
    case "s":
      // code for "down arrow" key press.
      down(5);
      break;
    case "w":
      // code for "up arrow" key press.
      up(5);
      break;
    default:
      return; // Quit when this doesn't handle the key event.
  }
});

redraw();
</script>
</body>
</html>
